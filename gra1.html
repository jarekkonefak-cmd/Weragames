<!DOCTYPE html>
<html lang="pl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Gra 1: Złap Serca</title>
    <style>
        body {
            margin: 0;
            padding: 0;
            background-color: #ffe6e6; /* Jasny róż */
            font-family: 'Verdana', sans-serif;
            overflow: hidden; /* Żeby nie było pasków przewijania */
            display: flex;
            flex-direction: column;
            align-items: center;
        }

        h2 { color: #d63384; margin-top: 10px; z-index: 10; }
        
        #score-board {
            font-size: 20px;
            color: #d63384;
            margin-bottom: 10px;
            font-weight: bold;
            z-index: 10;
        }

        canvas {
            background: #fff0f5;
            border: 4px solid #d63384;
            border-radius: 10px;
            box-shadow: 0 0 20px rgba(214, 51, 132, 0.3);
            display: block;
        }

        /* Przycisk powrotu */
        .back-btn {
            margin-top: 10px;
            text-decoration: none;
            color: #d63384;
            border: 1px solid #d63384;
            padding: 5px 10px;
            border-radius: 5px;
            z-index: 10;
        }

        /* Instrukcja dla gracza na start */
        #start-screen {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: rgba(255, 255, 255, 0.9);
            padding: 20px;
            border-radius: 10px;
            text-align: center;
            border: 2px solid #d63384;
            z-index: 20;
        }
        
        button {
            background: #d63384;
            color: white;
            border: none;
            padding: 10px 20px;
            font-size: 18px;
            border-radius: 5px;
            cursor: pointer;
        }
    </style>
</head>
<body>

    <h2>Złap 10 serc! ❤️</h2>
    <div id="score-board">Wynik: 0 / 10</div>
    
    <canvas id="gameCanvas"></canvas>

    <a href="index.html" class="back-btn">Wróć do Muzeum</a>

    <div id="start-screen">
        <h3>Zasady:</h3>
        <p>Ruszaj się myszką (lub palcem na telefonie).</p>
        <p>Złap 10 serduszek!</p>
        <button onclick="startGame()">START</button>
    </div>

    <script>
        // KONFIGURACJA
        const canvas = document.getElementById("gameCanvas");
        const ctx = canvas.getContext("2d");
        
        // Dopasowanie rozmiaru gry do ekranu
        canvas.width = Math.min(window.innerWidth - 20, 400); // Max 400px szerokości
        canvas.height = window.innerHeight - 150;

        let score = 0;
        let gameRunning = false;
        let player = { x: canvas.width / 2 - 25, y: canvas.height - 60, width: 50, height: 50 };
        let hearts = [];
        let speed = 3; // Prędkość spadania

        // --- MIEJSCE NA ZDJĘCIE TWARZY (później) ---
        // Gdy będziesz miał zdjęcie twarzy (np. twarz.png), 
        // odkomentuj te 2 linie poniżej i usuń rysowanie kwadratu w funkcji draw()
        
        // const playerImg = new Image();
        // playerImg.src = 'twarz.png'; 

        // --------------------------------------------

        function startGame() {
            document.getElementById("start-screen").style.display = "none";
            gameRunning = true;
            score = 0;
            hearts = [];
            updateGame();
            spawnHeart();
        }

        function spawnHeart() {
            if (!gameRunning) return;
            // Tworzymy serce w losowym miejscu na górze
            const x = Math.random() * (canvas.width - 30);
            hearts.push({ x: x, y: -30, size: 30 });
            
            // Nowe serce co 1 sekundę (1000ms)
            setTimeout(spawnHeart, 800);
        }

        function updateGame() {
            if (!gameRunning) return;

            // Czyścimy ekran
            ctx.clearRect(0, 0, canvas.width, canvas.height);

            // Rysujemy GRACZA (Twoja postać)
            ctx.fillStyle = "#333"; 
            // Jak będziesz miał zdjęcie, zamień linię poniżej na: ctx.drawImage(playerImg, player.x, player.y, 50, 50);
            ctx.fillRect(player.x, player.y, player.width, player.height); 

            // Rysujemy i przesuwamy SERCA
            ctx.fillStyle = "red";
            for (let i = 0; i < hearts.length; i++) {
                let h = hearts[i];
                h.y += speed; // Spadanie

                // Rysowanie serca (jako kółko na razie, lub emoji)
                ctx.font = "30px Arial";
                ctx.fillText("❤️", h.x, h.y);

                // Sprawdzenie kolizji (czy złapałeś serce)
                if (
                    h.x < player.x + player.width &&
                    h.x + h.size > player.x &&
                    h.y < player.y + player.height &&
                    h.y + h.size > player.y
                ) {
                    // ZŁAPANE!
                    score++;
                    document.getElementById("score-board").innerText = "Wynik: " + score + " / 10";
                    hearts.splice(i, 1); // Usuń serce
                    i--;

                    // SPRAWDZENIE WYGRANEJ
                    if (score >= 10) {
                        endGame();
                    }
                }

                // Jeśli serce spadło za nisko, usuń je
                if (h.y > canvas.height) {
                    hearts.splice(i, 1);
                    i--;
                }
            }

            requestAnimationFrame(updateGame);
        }

        function endGame() {
            gameRunning = false;
            // --- ZAPISUJEMY WYGRANĄ DO PAMIĘCI ---
            localStorage.setItem('wygrana1', 'tak'); // Kluczowe dla muzeum!
            
            alert("Brawo Kochanie! Zdobyłaś pierwsze wspomnienie! ❤️");
            window.location.href = "index.html"; // Powrót do muzeum
        }

        // STEROWANIE (Myszka / Dotyk)
        canvas.addEventListener("mousemove", (e) => {
            const rect = canvas.getBoundingClientRect();
            const root = document.documentElement;
            let mouseX = e.clientX - rect.left - root.scrollLeft;
            
            // Centrujemy postać na myszce
            player.x = mouseX - player.width / 2;
        });

        canvas.addEventListener("touchmove", (e) => {
            e.preventDefault(); // Blokuje przesuwanie ekranu palcem
            const rect = canvas.getBoundingClientRect();
            const touch = e.touches[0];
            let touchX = touch.clientX - rect.left;
            
            player.x = touchX - player.width / 2;
        }, { passive: false });

    </script>
</body>
</html>
