<!DOCTYPE html>
<html lang="pl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Nasze Pudełko Wspomnień</title>
    <link href="https://fonts.googleapis.com/css2?family=Dancing+Script:wght@600&family=Montserrat:wght@300;500&display=swap" rel="stylesheet">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>

    <style>
        :root {
            --wood-frame: #ffffff;
            --bg-paper: #f9f7f2;
            --gold-main: #d4af37;
            --gold-light: #fcf6ba;
            --text-dark: #422a2a;
        }

        body {
            margin: 0;
            padding: 0;
            background-color: #e0dcd5; /* Tło za pudełkiem */
            font-family: 'Montserrat', sans-serif;
            display: flex;
            flex-direction: column;
            align-items: center;
            min-height: 100vh;
        }

        /* --- GŁÓWNE PUDEŁKO (SHADOW BOX) --- */
        .shadow-box {
            width: 92%;
            max-width: 500px;
            background: var(--bg-paper);
            margin: 30px auto;
            padding: 40px 20px;
            border: 15px solid var(--wood-frame);
            position: relative;
            /* Potężny efekt głębi */
            box-shadow: 
                0 20px 50px rgba(0,0,0,0.2), 
                inset 0 0 60px rgba(0,0,0,0.05);
            border-radius: 2px;
        }

        /* Dekoracyjne światełko u góry */
        .spotlight {
            position: absolute;
            top: 0; left: 0; right: 0;
            height: 200px;
            background: radial-gradient(circle at 50% -10%, rgba(255, 255, 220, 0.5), transparent 70%);
            pointer-events: none;
        }

        header {
            text-align: center;
            margin-bottom: 50px;
        }

        h1 {
            font-family: 'Dancing Script', cursive;
            color: var(--text-dark);
            font-size: 2.8rem;
            margin: 0;
            letter-spacing: 1px;
        }

        .subtitle {
            font-size: 0.8rem;
            text-transform: uppercase;
            letter-spacing: 3px;
            color: #999;
            margin-top: 10px;
        }

        /* --- GALERIA PIONOWA --- */
        .gallery {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 50px;
        }

        .spot {
            position: relative;
            cursor: pointer;
            transition: transform 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275);
            -webkit-tap-highlight-color: transparent;
        }

        .spot:hover { transform: scale(1.03); }

        /* Kształty */
        .pion { width: 170px; height: 230px; }
        .poziom { width: 230px; height: 170px; }
        .kwadrat { width: 190px; height: 190px; }
        .owal { width: 180px; height: 220px; border-radius: 50%; }

        /* Gwóźdź */
        .nail {
            width: 8px; height: 8px;
            background: #444;
            border-radius: 50%;
            position: absolute;
            top: -20px; left: 50%;
            transform: translateX(-50%);
            box-shadow: 1px 1px 2px rgba(0,0,0,0.3);
            z-index: 5;
        }

        /* Linia przerywana */
        .placeholder {
            width: 100%; height: 100%;
            border: 1px dashed #bbb;
            display: flex;
            align-items: center;
            justify-content: center;
            text-align: center;
            color: #aaa;
            font-size: 0.75rem;
            font-style: italic;
            padding: 20px;
            box-sizing: border-box;
            background: rgba(0,0,0,0.01);
        }
        .owal .placeholder { border-radius: 50%; }

        /* --- ZŁOTA RAMA (FINALNA) --- */
        .frame {
            width: 100%; height: 100%;
            display: none;
            position: relative;
            background: white;
            padding: 6px;
            box-sizing: border-box;
            border: 2px solid #b88a44;
            /* Złożony efekt ramy */
            box-shadow: 
                0 10px 20px rgba(0,0,0,0.15),
                inset 0 0 0 4px var(--gold-main),
                inset 0 0 0 5px var(--gold-light);
            animation: hang 1.2s ease-out;
        }
        .owal .frame { border-radius: 50%; padding: 8px; }

        @keyframes hang {
            0% { transform: translateY(-20px) rotate(3deg); opacity: 0; }
            50% { transform: translateY(0) rotate(-2deg); }
            100% { transform: translateY(0) rotate(0); opacity: 1; }
        }

        .photo {
            width: 100%; height: 100%;
            object-fit: cover;
            display: block;
        }
        .owal .photo { border-radius: 50%; }

        /* --- PRZYCISK PDF --- */
        #pdf-container {
            text-align: center;
            margin-top: 60px;
            display: none;
        }

        .btn-pdf {
            background: linear-gradient(135deg, #d4af37, #b88a44);
            color: white;
            border: none;
            padding: 18px 35px;
            border-radius: 50px;
            font-family: 'Montserrat', sans-serif;
            font-weight: 500;
            cursor: pointer;
            box-shadow: 0 10px 20px rgba(212, 175, 55, 0.3);
            transition: 0.3s;
        }

        .btn-pdf:hover {
            transform: translateY(-3px);
            box-shadow: 0 15px 30px rgba(212, 175, 55, 0.5);
        }

        #reset-btn {
            background: none; border: none; color: #ccc;
            margin: 40px 0; cursor: pointer; font-size: 10px;
        }
    </style>
</head>
<body>

    <div class="shadow-box">
        <div class="spotlight"></div>
        
        <header>
            <h1>Nasza Historia</h1>
            <div class="subtitle">Kolekcja Wspomnień</div>
        </header>

        <div class="gallery">
            <div class="spot pion" onclick="gra(1)">
                <div class="nail"></div>
                <div class="placeholder" id="p1">Otwórz pierwsze okno</div>
                <div class="frame" id="f1"><img src="fotka1.jpg" class="photo" id="img1"></div>
            </div>

            <div class="spot poziom" onclick="gra(2)">
                <div class="nail"></div>
                <div class="placeholder" id="p2">Odkryj drugą chwilę</div>
                <div class="frame" id="f2"><img src="fotka2.jpg" class="photo" id="img2"></div>
            </div>

            <div class="spot kwadrat" onclick="gra(3)">
                <div class="nail"></div>
                <div class="placeholder" id="p3">Zajrzyj tutaj</div>
                <div class="frame" id="f3"><img src="fotka3.jpg" class="photo" id="img3"></div>
            </div>

            <div class="spot owal" onclick="gra(4)">
                <div class="nail"></div>
                <div class="placeholder" id="p4">Czwarta tajemnica</div>
                <div class="frame" id="f4"><img src="fotka4.jpg" class="photo" id="img4"></div>
            </div>

            <div class="spot poziom" onclick="gra(5)">
                <div class="nail"></div>
                <div class="placeholder" id="p5">Wielki finał</div>
                <div class="frame" id="f5"><img src="fotka5.jpg" class="photo" id="img5"></div>
            </div>
        </div>

        <div id="pdf-container">
            <button class="btn-pdf" onclick="generatePDF()">Zapisz nasze wspomnienia (PDF)</button>
        </div>
    </div>

    <button id="reset-btn" onclick="reset()">Resetuj postęp</button>

    <script>
        document.addEventListener("DOMContentLoaded", () => {
            let winCount = 0;
            for (let i = 1; i <= 5; i++) {
                if (localStorage.getItem('wygrana' + i) === 'tak') {
                    unlock(i);
                    winCount++;
                }
            }
            if(winCount === 5) document.getElementById('pdf-container').style.display = 'block';
        });

        function unlock(nr) {
            document.getElementById('p' + nr).style.display = 'none';
            document.getElementById('f' + nr).style.display = 'block';
            document.getElementById('f' + nr).parentElement.onclick = null;
        }

        function gra(nr) {
            window.location.href = 'gra' + nr + '.html';
        }

        function reset() {
            if(confirm("Zresetować?")) { localStorage.clear(); location.reload(); }
        }

        async function generatePDF() {
            const { jsPDF } = window.jspdf;
            const doc = new jsPDF();
            doc.setFont("times", "italic");
            doc.text("Nasza Kolekcja Wspomnień", 105, 20, null, null, "center");
            
            // To uproszczony generator - doda tylko te zdjęcia, które są w folderze
            for (let i = 1; i <= 5; i++) {
                const img = document.getElementById('img' + i);
                if (img.complete && img.naturalHeight !== 0) {
                    doc.addImage(img, 'JPEG', 50, 30 + (i * 40), 100, 70);
                }
            }
            doc.save("Nasze_Wspomnienia.pdf");
        }
    </script>
</body>
</html>
