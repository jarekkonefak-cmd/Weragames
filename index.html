<!DOCTYPE html>
<html lang="pl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Nasze Pude≈Çko Wspomnie≈Ñ</title>
    <link href="https://fonts.googleapis.com/css2?family=Dancing+Script:wght@600&family=Playfair+Display:ital@1&display=swap" rel="stylesheet">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>

    <style>
        /* --- BAZA I T≈ÅO (Styl Pude≈Çka) --- */
        body {
            margin: 0;
            padding: 0;
            background-color: #fdfbf7; /* Kremowe t≈Ço */
            font-family: 'Playfair Display', serif;
            min-height: 100vh;
            display: flex;
            flex-direction: column;
            align-items: center;
            overflow-x: hidden;
        }

        /* Imitacja wnƒôtrza pude≈Çka (Shadow Box) */
        .shadow-box-container {
            width: 90%;
            max-width: 600px; /* Szeroko≈õƒá na telefonie */
            background: #fff;
            margin: 20px auto;
            padding: 30px 20px;
            box-shadow: 
                inset 0 0 50px rgba(0,0,0,0.1), /* Cie≈Ñ wewnƒÖtrz */
                0 0 20px rgba(0,0,0,0.1); /* Cie≈Ñ na zewnƒÖtrz */
            border: 15px solid white; /* Gruba bia≈Ça rama pude≈Çka */
            border-radius: 5px;
            position: relative;
        }

        /* O≈õwietlenie LED (jak na zdjƒôciu) */
        .shadow-box-container::before {
            content: '';
            position: absolute;
            top: 0; left: 0; right: 0;
            height: 150px;
            background: radial-gradient(circle at top, rgba(255, 255, 200, 0.4), transparent 70%);
            pointer-events: none;
        }

        h1 {
            font-family: 'Dancing Script', cursive;
            color: #d4af37; /* Z≈Çoty tekst */
            text-align: center;
            font-size: 2.5rem;
            margin-bottom: 40px;
            text-shadow: 1px 1px 2px rgba(0,0,0,0.1);
        }

        /* --- UK≈ÅAD GALERII (Pionowy scroll) --- */
        .gallery-column {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 40px; /* Odstƒôpy miƒôdzy ramkami */
            width: 100%;
        }

        /* --- MIEJSCE NA ZDJƒòCIE (Spot) --- */
        .spot {
            position: relative;
            cursor: pointer;
            transition: transform 0.2s;
            /* KLUCZOWE DLA KLIKANIA NA TELEFONIE: */
            z-index: 10; 
            touch-action: manipulation;
        }

        .spot:active {
            transform: scale(0.95);
        }

        /* KSZTA≈ÅTY */
        .shape-portrait { width: 160px; height: 220px; }
        .shape-landscape { width: 220px; height: 160px; }
        .shape-square { width: 180px; height: 180px; }
        .shape-oval { width: 170px; height: 210px; border-radius: 50%; }

        /* --- STAN 1: NIEODBLOKOWANE (Przerywana linia) --- */
        .dashed-box {
            width: 100%;
            height: 100%;
            border: 2px dashed #ccc; /* Szara przerywana linia */
            border-radius: 5px;
            display: flex;
            align-items: center;
            justify-content: center;
            text-align: center;
            padding: 10px;
            box-sizing: border-box;
            background: rgba(0,0,0,0.02);
            color: #888;
            font-size: 0.9rem;
            font-style: italic;
        }

        .shape-oval .dashed-box { border-radius: 50%; }

        /* --- STAN 2: ODBLOKOWANE (Z≈Çota Rama) --- */
        .ornate-frame {
            width: 100%;
            height: 100%;
            display: none; /* Domy≈õlnie ukryte */
            /* Stylizacja z≈Çotej ramy - bogatsza */
            border: 8px solid #d4af37;
            border-radius: 3px;
            box-shadow: 
                0 5px 15px rgba(0,0,0,0.3), /* Cie≈Ñ rzucany przez ramkƒô */
                inset 0 0 10px rgba(0,0,0,0.5); /* Cie≈Ñ wewnƒÖtrz ramki */
            background: #000;
            overflow: hidden;
            position: relative;
            /* Imitacja z≈Çotej faktury */
            background-image: linear-gradient(45deg, #bf953f, #fcf6ba, #b38728, #fbf5b7, #aa771c);
            padding: 5px; /* Passe-partout (wewnƒôtrzna ramka) */
            box-sizing: border-box;
        }

        .shape-oval .ornate-frame {
            border-radius: 50%;
            padding: 6px;
        }

        /* Obrazek w ≈õrodku */
        .photo-content {
            width: 100%;
            height: 100%;
            object-fit: cover;
            display: block;
            background: white;
            border-radius: 1px;
            box-shadow: inset 0 0 5px rgba(0,0,0,0.5);
        }

        .shape-oval .photo-content { border-radius: 50%; }

        /* --- PRZYCISK PDF (Na dole) --- */
        #pdf-btn {
            margin-top: 50px;
            padding: 15px 30px;
            background: #d4af37;
            color: white;
            border: none;
            border-radius: 30px;
            font-size: 1.1rem;
            font-family: 'Playfair Display', serif;
            cursor: pointer;
            box-shadow: 0 5px 15px rgba(212, 175, 55, 0.4);
            display: none; /* Ukryty dop√≥ki nie wygrasz wszystkiego */
            animation: pulse 2s infinite;
        }

        @keyframes pulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.05); }
            100% { transform: scale(1); }
        }

        /* RESET (Ma≈Çy na dole) */
        #reset-btn {
            position: fixed;
            bottom: 10px;
            right: 10px;
            opacity: 0.2;
            font-size: 10px;
            background: none;
            border: 1px solid #ccc;
        }
    </style>
</head>
<body>

    <div class="shadow-box-container">
        <h1>Nasza Historia ‚ù§Ô∏è</h1>

        <div class="gallery-column" id="gallery">

            <div class="spot shape-portrait" onclick="idzDoGry(1)">
                <div class="dashed-box" id="dash-1">
                    Odblokuj pierwszy obraz
                </div>
                <div class="ornate-frame" id="frame-1">
                    <img src="fotka1.jpg" class="photo-content" id="img-1">
                </div>
            </div>

            <div class="spot shape-landscape" onclick="idzDoGry(2)">
                <div class="dashed-box" id="dash-2">
                    Odblokuj drugi obraz
                </div>
                <div class="ornate-frame" id="frame-2">
                    <img src="fotka2.jpg" class="photo-content" id="img-2">
                </div>
            </div>

            <div class="spot shape-square" onclick="idzDoGry(3)">
                <div class="dashed-box" id="dash-3">
                    Odblokuj trzeci obraz
                </div>
                <div class="ornate-frame" id="frame-3">
                    <img src="fotka3.jpg" class="photo-content" id="img-3">
                </div>
            </div>

            <div class="spot shape-oval" onclick="idzDoGry(4)">
                <div class="dashed-box" id="dash-4">
                    Odblokuj czwarty obraz
                </div>
                <div class="ornate-frame" id="frame-4">
                    <img src="fotka4.jpg" class="photo-content" id="img-4">
                </div>
            </div>

            <div class="spot shape-landscape" onclick="idzDoGry(5)">
                <div class="dashed-box" id="dash-5">
                    Odblokuj piƒÖty obraz
                </div>
                <div class="ornate-frame" id="frame-5">
                    <img src="fotka5.jpg" class="photo-content" id="img-5">
                </div>
            </div>

        </div>

        <div style="text-align: center;">
            <button id="pdf-btn" onclick="generujPDF()">üéÅ Pobierz Wspomnienia (PDF)</button>
        </div>

    </div>

    <button id="reset-btn" onclick="resetuj()">RESET</button>

    <script>
        // --- LOGIKA ---
        
        // Sprawdzanie stanu gier przy uruchomieniu
        document.addEventListener("DOMContentLoaded", () => {
            let wygraneLicznik = 0;

            for (let i = 1; i <= 5; i++) {
                if (localStorage.getItem('wygrana' + i) === 'tak') {
                    pokazObraz(i);
                    wygraneLicznik++;
                }
            }

            // Je≈õli wszystkie 5 gier wygranych, poka≈º przycisk PDF
            if (wygraneLicznik === 5) {
                document.getElementById('pdf-btn').style.display = 'inline-block';
            }
        });

        function pokazObraz(nr) {
            // Ukryj przerywanƒÖ liniƒô
            const dash = document.getElementById('dash-' + nr);
            if(dash) dash.style.display = 'none';
            
            // Poka≈º ramƒô
            const frame = document.getElementById('frame-' + nr);
            if(frame) frame.style.display = 'block';
            
            // Zablokuj klikanie (≈ºeby nie wchodziƒá do gry po wygranej)
            const parent = frame.parentElement;
            parent.onclick = () => {
                // Tu mo≈ºemy dodaƒá np. powiƒôkszanie zdjƒôcia w przysz≈Ço≈õci
                console.log("Obraz ju≈º odblokowany");
            };
            parent.style.cursor = 'default';
        }

        function idzDoGry(nr) {
            // Sprawd≈∫ czy gra nie jest ju≈º wygrana
            if (localStorage.getItem('wygrana' + nr) !== 'tak') {
                console.log("Przechodzƒô do gry numer: " + nr);
                window.location.href = 'gra' + nr + '.html';
            }
        }

        function resetuj() {
            if(confirm("Czy na pewno chcesz zresetowaƒá ca≈Çy postƒôp?")) {
                localStorage.clear();
                location.reload();
            }
        }

        // --- GENEROWANIE PDF ---
        async function generujPDF() {
            const { jsPDF } = window.jspdf;
            const doc = new jsPDF();

            doc.setFont("times", "italic");
            doc.setFontSize(24);
            doc.text("Nasza Kolekcja Wspomnie≈Ñ", 105, 20, null, null, "center");
            
            doc.setFontSize(12);
            doc.text("Dla mojej Walentynki ‚ù§Ô∏è", 105, 30, null, null, "center");

            let yPos = 50;

            // Pobieramy obrazy i dodajemy do PDF
            for (let i = 1; i <= 5; i++) {
                const imgElement = document.getElementById('img-' + i);
                
                // Sprawdzamy, czy zdjƒôcie siƒô za≈Çadowa≈Ço (czy nie jest puste)
                if (imgElement.complete && imgElement.naturalHeight !== 0) {
                    try {
                        // Dodajemy obraz do PDF
                        // Parametry: data obrazu, typ, x, y, szeroko≈õƒá, wysoko≈õƒá
                        doc.addImage(imgElement, "JPEG", 55, yPos, 100, 75); // Ustawiamy sta≈Çy rozmiar w PDF
                        yPos += 85; // Przesuwamy w d√≥≈Ç dla kolejnego zdjƒôcia

                        // Je≈õli brakuje miejsca na stronie, dodaj nowƒÖ
                        if (yPos > 250 && i < 5) {
                            doc.addPage();
                            yPos = 20;
                        }
                    } catch (e) {
                        console.error("B≈ÇƒÖd dodawania zdjƒôcia do PDF", e);
                    }
                } else {
                    doc.text(`[Miejsce na zdjƒôcie nr ${i}]`, 105, yPos + 40, null, null, "center");
                    yPos += 85;
                }
            }

            doc.save("Nasze_Wspomnienia.pdf");
        }
    </script>
</body>
</html>
